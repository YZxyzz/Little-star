# 隐私合规框架

## 一、合规背景

### 1.1 适用法规

| 法规 | 适用地区 | 关键要求 |
|------|---------|---------|
| 《个人信息保护法》(PIPL) | 中国 | 知情同意、最小必要、安全保护 |
| 《儿童个人信息网络保护规定》 | 中国 | 监护人同意、特殊保护措施 |
| 《数据安全法》 | 中国 | 数据分类分级、安全评估 |
| COPPA | 美国 | 13岁以下儿童特殊保护 |
| GDPR | 欧盟 | 知情同意、数据可携带 |

### 1.2 监管趋势

- 2025年FTC加强对AI儿童产品的审查
- 中国网络空间安全协会发布《智能玩具个人信息保护倡议》
- 教育部发布《中小学生成式人工智能使用指南》

### 1.3 合规原则

1. **儿童利益最大化**：所有设计以儿童利益为首要考量
2. **最小必要原则**：只收集实现功能必需的数据
3. **透明公开原则**：清晰告知数据用途
4. **安全保护原则**：采取严格安全措施
5. **家长控制原则**：赋予家长完全控制权

---

## 二、数据分类与处理

> ⚠️ **更新 (2025-02-05)**：引入P0-P3四级隐私分类体系，针对长录音场景强化数据保护。

### 2.1 隐私分级体系（P0-P3）

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         隐私分级体系 (P0-P3)                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   P0 - 最敏感          P1 - 敏感           P2 - 中等          P3 - 公开      │
│   ═══════════          ═══════════         ═══════════        ═══════════   │
│                                                                             │
│   永不离开设备         仅摘要上云          用户授权后上传       自动同步      │
│   本地加密存储         脱敏后调用API       云端加密存储        标准处理      │
│                                                                             │
│   • 原始音频           • 孩子姓名          • AI报告            • 使用统计    │
│   • 完整转写           • 出生日期          • 育儿建议          • 功能偏好    │
│   • 敏感对话           • 手机号            • 情绪分析          • 设备信息    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 数据分类详情

| 隐私级别 | 数据类别 | 示例 | 存储位置 | 传输策略 | AI处理 | 保留期限 |
|---------|---------|------|---------|---------|--------|---------|
| **P0** | 原始录音 | 音频文件、完整转写 | **仅本地设备** | 永不上传 | 仅本地模型 | 用户控制 |
| **P1** | 孩子档案 | 姓名、生日、敏感对话 | 本地优先 | 仅摘要上传 | 脱敏后API | 账户存续期 |
| **P2** | AI分析 | 报告、建议、情绪分析 | 云端加密 | 用户授权 | 云端模型 | 用户设置(默认1年) |
| **P3** | 使用日志 | 操作记录、功能偏好 | 云端 | 自动同步 | 分析专用 | 90天 |

### 2.3 传统数据分类（兼容）

| 数据类别 | 敏感级别 | 对应隐私级别 | 示例 | 存储位置 | 保留期限 |
|---------|---------|-------------|------|---------|---------|
| 账户数据 | 中 | P1 | 手机号、昵称 | 本地优先/云端加密 | 账户存续期 |
| 孩子档案 | 高 | P1 | 姓名、生日、性别 | 本地优先/云端脱敏 | 账户存续期 |
| 语音数据 | **最高** | **P0** | 原始录音文件 | **仅本地设备** | 用户控制 |
| 文字记录 | 中-高 | P1/P2 | 家长输入内容 | 本地优先/云端加密 | 用户设置 |
| AI分析结果 | 中 | P2 | 报告、建议 | 云端加密 | 用户设置(默认1年) |
| 使用日志 | 低 | P3 | APP操作记录 | 云端 | 90天 |

### 2.4 数据处理原则

```
┌─────────────────────────────────────────────────────────────┐
│                    数据处理流程（隐私分级）                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  收集 ──▶ 分级 ──▶ 传输 ──▶ 存储 ──▶ 处理 ──▶ 删除          │
│   │        │        │        │        │        │           │
│   ▼        ▼        ▼        ▼        ▼        ▼           │
│ 最小化   P0-P3    按级别   按级别   按级别   彻底删除        │
│ 知情同意  分类    选择性   加密     处理    不可恢复         │
│                                                             │
│  P0: 收集→本地存储→本地处理→用户控制删除                     │
│  P1: 收集→脱敏→云端摘要→脱敏API→账户期删除                   │
│  P2: 收集→加密→云端存储→云端处理→用户设置删除                │
│  P3: 收集→匿名化→自动同步→分析专用→90天删除                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.5 本地优先架构（P0数据保护）

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   本地优先数据架构（P0-P3分级）                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                      本地设备（毛绒硬件/APP）                         │  │
│   │                                                                      │  │
│   │   ┌─────────────────────────────────────────────────────────────┐   │  │
│   │   │              P0 数据区（永不离开设备）                        │   │  │
│   │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐    │   │  │
│   │   │   │  原始音频    │  │  完整转写    │  │  敏感对话内容   │    │   │  │
│   │   │   │  (AES-256)  │  │  (AES-256)  │  │  (设备密钥)     │    │   │  │
│   │   │   └─────────────┘  └─────────────┘  └─────────────────┘    │   │  │
│   │   │                        │                                    │   │  │
│   │   │                        ▼ 本地AI处理（Qwen 2.5 本地版）       │   │  │
│   │   └─────────────────────────────────────────────────────────────┘   │  │
│   │                            │                                        │  │
│   │                            ▼ 隐私分级处理器                          │  │
│   │                            │                                        │  │
│   │   ┌─────────────────────────────────────────────────────────────┐   │  │
│   │   │              P1 数据区（本地优先，摘要可上云）                 │   │  │
│   │   │   ┌─────────────┐  ┌─────────────┐                          │   │  │
│   │   │   │  孩子档案    │  │  脱敏摘要    │────── 可选上传 ────────▶│   │  │
│   │   │   │  (完整版)   │  │  (抽象版)   │      （仅摘要）          │   │  │
│   │   │   └─────────────┘  └─────────────┘                          │   │  │
│   │   └─────────────────────────────────────────────────────────────┘   │  │
│   │                            │                                        │  │
│   └────────────────────────────┼────────────────────────────────────────┘  │
│                                │                                           │
│                                ▼ 用户明确授权后                             │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         云端服务                                     │  │
│   │                                                                      │  │
│   │   ┌──────────────────────────────────────────────────────────────┐  │  │
│   │   │                 P2 数据区（云端加密存储）                      │  │  │
│   │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐ │  │  │
│   │   │   │  AI报告     │  │  育儿建议   │  │  情绪分析结果        │ │  │  │
│   │   │   │  (加密)     │  │  (加密)     │  │  (加密)             │ │  │  │
│   │   │   └─────────────┘  └─────────────┘  └─────────────────────┘ │  │  │
│   │   └──────────────────────────────────────────────────────────────┘  │  │
│   │                                                                      │  │
│   │   ┌──────────────────────────────────────────────────────────────┐  │  │
│   │   │                 P3 数据区（匿名分析数据）                      │  │  │
│   │   │   ┌─────────────┐  ┌─────────────┐                           │  │  │
│   │   │   │  使用统计    │  │  功能偏好   │  （仅用于产品改进）       │  │  │
│   │   │   │  (匿名化)   │  │  (匿名化)   │                           │  │  │
│   │   │   └─────────────┘  └─────────────┘                           │  │  │
│   │   └──────────────────────────────────────────────────────────────┘  │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   关键特性：                                                                │
│   1. **P0原始音频永不离开设备**，本地AI处理，设备密钥加密                    │
│   2. P1敏感信息本地完整存储，云端仅存脱敏摘要                               │
│   3. P2分析结果用户授权后方可上传，云端加密存储                             │
│   4. P3匿名统计数据可自动同步（用户可关闭）                                 │
│   5. 用户可随时导出所有数据、删除所有数据                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 三、知情同意机制

### 3.1 同意层级

| 同意类型 | 触发时机 | 同意方式 | 可选性 |
|---------|---------|---------|-------|
| 服务协议 | 注册时 | 勾选确认 | 必须 |
| 隐私政策 | 注册时 | 阅读确认 | 必须 |
| 监护人验证 | 添加孩子时 | 实名+短信验证 | 必须 |
| 录音权限 | 首次录音 | 系统权限+二次确认 | 可选 |
| 云端存储 | 首次上传 | 明确选择 | 可选 |
| AI训练 | 设置页 | 明确选择 | 可选（默认关闭）|

### 3.2 监护人验证流程

```
┌─────────────────────────────────────────────────────────────┐
│                  监护人验证流程                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 创建孩子档案                                            │
│       │                                                    │
│       ▼                                                    │
│  2. 弹出监护人验证说明                                       │
│     "根据《儿童个人信息网络保护规定》，添加儿童档案需要        │
│      验证您的监护人身份..."                                  │
│       │                                                    │
│       ▼                                                    │
│  3. 手机号验证                                              │
│     - 输入手机号                                            │
│     - 获取验证码                                            │
│     - 验证成功                                              │
│       │                                                    │
│       ▼                                                    │
│  4. 监护关系声明                                            │
│     "我声明我是该儿童的合法监护人，我同意为其创建档案..."     │
│     [ ] 我已阅读并同意《儿童隐私保护协议》                    │
│       │                                                    │
│       ▼                                                    │
│  5. 验证完成，创建档案                                       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 权限请求话术

**录音权限请求**
```
小星伴需要使用麦克风来记录语音

用于：
• 记录您对孩子成长的语音描述
• 生成每日成长报告

您的录音数据：
• 默认仅存储在您的手机上
• 您可以选择是否同步到云端
• 您可以随时删除所有录音

[暂不开启]  [允许]
```

---

## 四、用户权利保障

### 4.1 用户权利清单

| 权利 | 实现方式 | 响应时限 |
|------|---------|---------|
| 知情权 | 隐私政策、数据看板 | 实时 |
| 访问权 | 数据导出功能 | 24小时内 |
| 更正权 | 编辑功能 | 实时 |
| 删除权 | 删除功能、注销账户 | 72小时内 |
| 撤回同意权 | 设置页取消授权 | 实时 |
| 可携带权 | 数据导出（JSON/CSV） | 24小时内 |

### 4.2 数据导出格式

```json
{
  "export_info": {
    "export_date": "2025-01-15",
    "user_id": "xxx",
    "data_range": "2024-01-01 to 2025-01-15"
  },
  "user_profile": {
    "phone": "138****8000",
    "nickname": "xxx",
    "created_at": "2024-06-01"
  },
  "children": [
    {
      "id": "xxx",
      "name": "xxx",
      "birth_date": "2020-06-15",
      "records_count": 156,
      "reports_count": 52
    }
  ],
  "records": [
    {
      "id": "xxx",
      "date": "2025-01-15",
      "content": "xxx",
      "audio_file": "records/xxx.m4a"
    }
  ],
  "reports": [
    {
      "id": "xxx",
      "date": "2025-01-15",
      "type": "daily",
      "content": {...}
    }
  ]
}
```

### 4.3 账户注销流程

1. 进入设置 > 账户 > 注销账户
2. 显示注销影响说明
3. 输入手机验证码确认
4. 选择数据处理方式：
   - 导出数据后删除
   - 直接删除所有数据
5. 7天冷静期（可撤销）
6. 7天后彻底删除所有数据

---

## 五、数据安全措施

### 5.1 技术安全措施

| 层面 | 措施 | 标准/工具 |
|------|------|---------|
| 传输加密 | TLS 1.3 | HTTPS强制 |
| 存储加密 | AES-256 | 服务端加密 |
| 密钥管理 | KMS | 阿里云密钥管理 |
| 访问控制 | RBAC | 最小权限原则 |
| 审计日志 | 全量记录 | 保留180天 |
| 入侵检测 | WAF + IDS | 阿里云安全中心 |

### 5.2 数据隔离

```
┌─────────────────────────────────────────────────────────────┐
│                    数据隔离架构                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   用户A数据          用户B数据          用户C数据            │
│   ┌─────────┐       ┌─────────┐       ┌─────────┐          │
│   │ user_a  │       │ user_b  │       │ user_c  │          │
│   │ 加密存储 │       │ 加密存储 │       │ 加密存储 │          │
│   │ 独立密钥 │       │ 独立密钥 │       │ 独立密钥 │          │
│   └─────────┘       └─────────┘       └─────────┘          │
│        │                 │                 │               │
│        └─────────────────┼─────────────────┘               │
│                          │                                 │
│                    ┌─────▼─────┐                           │
│                    │  访问控制  │                           │
│                    │ Row-Level │                           │
│                    │ Security  │                           │
│                    └───────────┘                           │
│                                                             │
│   原则：                                                    │
│   1. 每个用户数据逻辑隔离                                    │
│   2. 每个用户独立加密密钥                                    │
│   3. 行级别安全策略                                         │
│   4. 即使数据库泄露也无法交叉访问                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.3 AI处理安全（多模型编排）

> **更新**：针对多模型编排架构的AI处理安全策略。

| 隐私级别 | AI处理位置 | 使用模型 | 安全措施 |
|---------|-----------|---------|---------|
| **P0** | **仅本地设备** | Qwen 2.5 本地版 | 数据永不离开设备，本地推理 |
| **P1** | 本地或云端脱敏 | 云端API（脱敏后） | 去除PII后调用，不传用户ID |
| **P2** | 云端加密处理 | MiniMax / Qwen Audio | 加密传输，处理后删除原始数据 |
| **P3** | 云端分析 | 分析专用 | 完全匿名化，仅用于产品改进 |

| 处理环节 | 安全措施 |
|---------|---------|
| 语音识别 | P0数据本地识别；P1/P2数据云端处理后立即删除原始音频 |
| 深度推理 | P0/P1数据使用脱敏摘要；P2数据加密传输 |
| LLM调用 | 不传递用户ID、孩子真实姓名等标识信息 |
| 结果存储 | 按隐私级别分区存储，P0结果仅本地保存 |
| 模型训练 | **默认不使用用户数据**，P3数据需明确同意 |
| 多模型路由 | 根据数据隐私级别自动路由到合适的处理模型 |

### 5.4 端侧AI处理能力

```
┌─────────────────────────────────────────────────────────────┐
│                 端侧AI处理（P0数据专用）                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   本地部署模型：Qwen 2.5 Lite（量化版）                       │
│                                                             │
│   支持能力：                                                 │
│   • 语音转文字（准确率>90%）                                 │
│   • 简单问答（快速响应<500ms）                               │
│   • 敏感词检测（实时）                                       │
│   • 隐私分级标记（自动）                                     │
│                                                             │
│   不支持（需要云端）：                                        │
│   • 复杂推理分析                                             │
│   • 深度报告生成                                             │
│   • 多日趋势分析                                             │
│                                                             │
│   优势：                                                     │
│   • P0数据零泄露风险                                         │
│   • 离线可用                                                 │
│   • 响应速度快                                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 六、隐私政策要点

### 6.1 必须披露的信息

1. **收集的信息类型**
   - 账户信息：手机号、昵称
   - 孩子信息：姓名、生日、性别
   - 使用数据：录音、文字记录
   - 设备信息：设备型号、操作系统

2. **信息使用目的**
   - 提供核心服务功能
   - 生成成长报告
   - 提供育儿建议
   - 改进服务质量（需单独同意）

3. **信息共享情况**
   - 云服务商（阿里云）：数据存储
   - AI服务商（通义千问）：文本处理
   - 不向任何第三方出售数据

4. **数据保留期限**
   - 录音数据：用户可设置（默认90天）
   - 文字记录：用户可设置（默认1年）
   - 账户数据：账户存续期
   - 注销后：7天内删除

5. **用户权利**
   - 访问、更正、删除个人信息
   - 撤回同意
   - 导出数据
   - 注销账户

### 6.2 儿童隐私专项说明

```
《儿童个人信息保护协议》要点

1. 信息收集
   我们收集的儿童信息仅限于：
   - 姓名/昵称（用于个性化称呼）
   - 出生日期（用于计算年龄，提供适龄内容）
   - 性别（用于个性化报告）
   
2. 监护人同意
   - 添加儿童档案需验证监护人身份
   - 所有儿童数据处理需监护人事先同意
   
3. 特殊保护
   - 儿童数据采用最高级别加密保护
   - 不将儿童数据用于广告或营销
   - 不向任何第三方分享可识别儿童身份的信息
   
4. 监护人权利
   - 随时查看、修改、删除儿童信息
   - 撤回对儿童数据处理的同意
   - 导出儿童相关所有数据

5. 联系我们
   如有任何关于儿童隐私的问题，请联系：
   privacy@littlestar.com
```

---

## 七、合规检查清单

### 7.1 上线前检查

| 检查项 | 状态 | 负责人 |
|--------|------|--------|
| 隐私政策审核通过 | ☐ | 法务 |
| 用户协议审核通过 | ☐ | 法务 |
| 儿童隐私协议审核通过 | ☐ | 法务 |
| 监护人验证流程测试 | ☐ | 产品 |
| 数据导出功能测试 | ☐ | 技术 |
| 数据删除功能测试 | ☐ | 技术 |
| 加密方案安全审计 | ☐ | 安全 |
| 权限请求话术审核 | ☐ | 法务 |
| 第三方SDK隐私审查 | ☐ | 技术 |

### 7.2 定期检查（季度）

| 检查项 | 频率 |
|--------|------|
| 隐私政策更新审查 | 季度 |
| 数据访问日志审计 | 月度 |
| 安全漏洞扫描 | 周度 |
| 用户权利请求响应时效 | 月度 |
| 第三方服务商合规审查 | 季度 |

---

## 八、应急响应

### 8.1 数据泄露响应流程

```
┌─────────────────────────────────────────────────────────────┐
│                  数据泄露响应流程                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  发现泄露                                                   │
│      │                                                     │
│      ▼                                                     │
│  1. 立即止损（24小时内）                                     │
│     - 隔离受影响系统                                        │
│     - 修复安全漏洞                                          │
│     - 保存证据                                              │
│      │                                                     │
│      ▼                                                     │
│  2. 评估影响（48小时内）                                     │
│     - 确定泄露范围                                          │
│     - 评估风险等级                                          │
│     - 识别受影响用户                                        │
│      │                                                     │
│      ▼                                                     │
│  3. 通知相关方（72小时内）                                   │
│     - 通知监管部门（如涉及敏感数据）                         │
│     - 通知受影响用户                                        │
│     - 提供补救措施                                          │
│      │                                                     │
│      ▼                                                     │
│  4. 后续处理                                                │
│     - 完善安全措施                                          │
│     - 总结复盘                                              │
│     - 更新应急预案                                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 用户通知模板

```
【重要通知】关于数据安全事件的说明

尊敬的用户：

我们发现在[日期]发生了一起数据安全事件，可能涉及您的以下信息：
- [具体信息类型]

我们已采取的措施：
1. [措施1]
2. [措施2]

建议您采取的措施：
1. [建议1]
2. [建议2]

如有任何疑问，请联系：
- 客服热线：xxx
- 邮箱：security@littlestar.com

我们对此事件给您带来的不便深表歉意，将持续加强安全保护措施。

小星伴团队
[日期]
```
